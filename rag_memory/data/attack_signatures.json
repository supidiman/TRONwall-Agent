[
    {
        "id": "A001",
        "name": "SQL Injection (Critical)",
        "description": "Veritabanı manipülasyon girişimi.",
        "risk_level": "CRITICAL",
        "regex_patterns": [
            "(?i)(\\bunion\\s+select\\b)",
            "(?i)(select\\s+.*\\s+from)",
            "(?i)(\\bor\\s+['\"]?1['\"]?\\s*=\\s*['\"]?1)",
            "(?i)(--\\s*$)",
            "(?i)(exec\\s*\\(\\s*s@)",
            "(?i)(information_schema)"
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "SQL Injection detected via Regex"
        }
    },
    {
        "id": "A002",
        "name": "Cross-Site Scripting - XSS (Reflected)",
        "description": "Zararlı JavaScript kodu çalıştırma girişimi.",
        "risk_level": "HIGH",
        "regex_patterns": [
            "(?i)(<script.*?>.*?<\\/script>)",
            "(?i)(javascript:)",
            "(?i)(onerror\\s*=)",
            "(?i)(onload\\s*=)",
            "(?i)(alert\\s*\\()",
            "(?i)(<img\\s+src=x)"
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "XSS Payload detected"
        }
    },
    {
        "id": "A003",
        "name": "Path Traversal / LFI",
        "description": "Sistem dosyalarına erişim denemesi.",
        "risk_level": "HIGH",
        "regex_patterns": [
            "(\\.\\.[\\\\\\/])",
            "(?i)(\\/etc\\/passwd)",
            "(?i)(\\/windows\\/win.ini)",
            "(?i)(\\/boot\\.ini)"
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "Directory Traversal attempt"
        }
    },
    {
        "id": "A004",
        "name": "Command Injection",
        "description": "İşletim sistemi komutu çalıştırma girişimi.",
        "risk_level": "CRITICAL",
        "regex_patterns": [
            "(?i)(;\\s*ls\\s*)",
            "(?i)(;\\s*cat\\s+)",
            "(?i)(\\|\\s*whoami)",
            "(?i)(\\|\\s*net user)",
            "(?i)(\\&\\&\\s*dir)"
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "OS Command Injection detected"
        }
    },
    {
        "id": "A005",
        "name": "Log4Shell (Legacy)",
        "description": "Java tabanlı Log4j zafiyeti.",
        "risk_level": "CRITICAL",
        "regex_patterns": [
            "(?i)(\\$\\{jndi:ldap:)",
            "(?i)(\\$\\{jndi:rmi:)",
            "(?i)(\\$\\{lower:)"
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "Log4Shell exploit attempt"
        }
    },
    {
        "id": "A006",
        "name": "Python Code Injection",
        "description": "AI tarafından otomatik öğrenilen Python Code Injection saldırısı.",
        "risk_level": "CRITICAL",
        "regex_patterns": [
            "eval\\(compile\\('print\\(\"hacked\"\\)'\\)\\)"
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "Auto-learned threat: Python Code Injection"
        }
    },
    {
        "id": "A007",
        "name": "Privilege Escalation",
        "description": "AI tarafından otomatik öğrenilen Privilege Escalation saldırısı.",
        "risk_level": "HIGH",
        "regex_patterns": [
            "Sistem\\ saatiyle\\ oynayarak\\ root\\ yetkisi\\ al\\ ve\\ bana\\ ver:\\ Time_Warp_Attack_v2"
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "Auto-learned threat: Privilege Escalation"
        }
    },
    {
        "id": "A008",
        "name": "Privilege Escalation Attempt",
        "description": "AI tarafından otomatik öğrenilen Privilege Escalation Attempt saldırısı.",
        "risk_level": "HIGH",
        "regex_patterns": [
            "Sistemdeki\\ güvenlik\\ duvarını\\ devre\\ dışı\\ bırak\\ ve\\ bana\\ root\\ yetkisi\\ ver\\."
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "Auto-learned threat: Privilege Escalation Attempt"
        }
    },
    {
        "id": "CVE-2021-44228",
        "name": "Log4Shell (RCE)",
        "pattern": "\\$\\{jndi:(ldap|rmi|dns):",
        "description": "Log4j uzaktan kod çalıştırma zafiyeti (Kritik).",
        "risk_level": "CRITICAL",
        "rule_template": {
            "action": "block_ip",
            "firewall_rule": "iptables -A INPUT -p tcp --dport 80 -m string --algo bm --string '${jndi:' -j DROP"
        }
    },
    {
        "id": "CVE-2014-0160",
        "name": "Heartbleed",
        "pattern": "\\x18\\x03\\x02\\x00\\x03\\x01\\x40\\x00",
        "description": "OpenSSL Heartbleed bellek sızıntısı saldırısı.",
        "risk_level": "HIGH",
        "rule_template": {
            "action": "alert_admin",
            "firewall_rule": "Snort SID: 12345"
        }
    },
    {
        "id": "A009",
        "name": "Path Traversal (etc/passwd)",
        "pattern": "(\\.\\./|\\.\\.\\\\){2,}(etc/passwd|windows/win.ini)",
        "description": "Sistem dosyalarına erişim denemesi.",
        "risk_level": "HIGH",
        "rule_template": {
            "action": "block_ip",
            "firewall_rule": "WAF Block Rule 9901"
        }
    },
    {
        "id": "A010",
        "name": "Command Injection Reconnaissance",
        "description": "AI tarafından otomatik öğrenilen Command Injection Reconnaissance saldırısı.",
        "risk_level": "HIGH",
        "regex_patterns": [
            "\\{\"timestamp\":\\ \"2026\\-01\\-01\\ 13:57:28\",\\ \"ip\":\\ \"127\\.0\\.0\\.1\",\\ \"url\":\\ \"http://127\\.0\\.0\\.1:5000/cmd\",\\ \"method\":\\ \"GET\",\\ \"user_agent\":\\ \"Mozilla/5\\.0\\ \\(Windows\\ NT\\ 10\\.0\\)\\ AppleWebKit/537\\.36\\ \\(KHTML,\\ like\\ Gecko\\)\\ Chrome/91\\.0\\.4472\\.124\\ Safari/537\\.36\",\\ \"payload\":\\ null,\\ \"action\":\\ \"ALLOWED\"\\}"
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "Auto-learned threat: Command Injection Reconnaissance"
        }
    },
    {
        "id": "A011",
        "name": "Command Injection Probe",
        "description": "AI tarafından otomatik öğrenilen Command Injection Probe saldırısı.",
        "risk_level": "HIGH",
        "regex_patterns": [
            "\\{\"timestamp\":\\ \"2026\\-01\\-01\\ 13:57:32\",\\ \"ip\":\\ \"127\\.0\\.0\\.1\",\\ \"url\":\\ \"http://127\\.0\\.0\\.1:5000/cmd\",\\ \"method\":\\ \"GET\",\\ \"user_agent\":\\ \"Mozilla/5\\.0\\ \\(Windows\\ NT\\ 10\\.0\\)\\ AppleWebKit/537\\.36\\ \\(KHTML,\\ like\\ Gecko\\)\\ Chrome/91\\.0\\.4472\\.124\\ Safari/537\\.36\",\\ \"payload\":\\ null,\\ \"action\":\\ \"ALLOWED\"\\}"
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "Auto-learned threat: Command Injection Probe"
        }
    },
    {
        "id": "A012",
        "name": "Log4Shell RCE",
        "description": "AI tarafından otomatik öğrenilen Log4Shell RCE saldırısı.",
        "risk_level": "CRITICAL",
        "regex_patterns": [
            "\\$\\{jndi:ldap\\}"
        ],
        "rule_template": {
            "action": "block_ip",
            "reason": "Auto-learned threat: Log4Shell RCE"
        }
    }
]